# STIG ID: [WN10-CC-000245](https://stigaview.com/products/win10/v2r8/WN10-CC-000245/)

## Vulnerability Discussion

Passwords save locally for re-use when browsing may be subject to compromise. Disabling the Edge password manager will prevent this for the browser.
Check

## Compliance Check
Windows 10 LTSC\B versions do not include Microsoft Edge, this is NA for those systems.

If the following registry value does not exist or is not configured as specified, this is a finding.

Registry Hive: `HKEY_LOCAL_MACHINE`
Registry Path: `\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main\`

Value Name: `FormSuggest Passwords`

Type: `REG_SZ`
Value: `no`

## Remediation
 Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Microsoft Edge >> "Configure Password Manager" to "Disabled".
 
## Powershell Remediation Script
```
# Define registry details
$RegistryHive = "HKLM:\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main"
$ValueName = "FormSuggest Passwords"
$ValueType = "String"
$ValueData = "no"

# Check if the registry path exists
if (-not (Test-Path $RegistryHive)) {
    Write-Output "Registry path does not exist. Creating path: $RegistryHive"
    New-Item -Path $RegistryHive -Force | Out-Null
}

# Check if the registry value exists and is configured correctly
$CurrentValue = (Get-ItemProperty -Path $RegistryHive -Name $ValueName -ErrorAction SilentlyContinue).$ValueName
if ($CurrentValue -ne $ValueData) {
    Write-Output "Configuring registry value: $ValueName"
    Set-ItemProperty -Path $RegistryHive -Name $ValueName -Value $ValueData -Force
    Write-Output "Registry value configured successfully: $ValueName = $ValueData"
} else {
    Write-Output "Registry value is already configured correctly: $ValueName = $ValueData"
}

# Verify the configuration
$ConfiguredValue = (Get-ItemProperty -Path $RegistryHive -Name $ValueName -ErrorAction SilentlyContinue).$ValueName
if ($ConfiguredValue -eq $ValueData) {
    Write-Output "Verification successful: Registry value is configured correctly."
} else {
    Write-Output "Verification failed: Registry value is not configured as expected."
}
```
