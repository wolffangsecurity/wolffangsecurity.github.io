# STIG ID: [WN10-CC-000330](https://stigaview.com/products/win10/v2r8/WN10-CC-000330/)

## Vulnerability Discussion
Basic authentication uses plain text passwords that could be used to compromise a system.

## Compliance Check
If the following registry value does not exist or is not configured as specified, this is a finding:

Registry Hive: `HKEY_LOCAL_MACHINE`
Registry Path: `\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client\`

Value Name: `AllowBasic`

Value Type: `REG_DWORD`
Value: `0`

## Remediation
Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> Windows Remote Management (WinRM) >> WinRM Client >> "Allow Basic authentication" to "Disabled".

## Powershell Remediation Script
```
# Check for administrative privileges
if (-not ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
    Write-Error "This script requires administrative privileges. Please run PowerShell as an administrator."
    exit
}

# Check for administrative privileges
if (-not ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
    Write-Error "This script requires administrative privileges. Please run PowerShell as an administrator."
    exit
}

# Define the registry path and values
$RegistryPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client"
$ValueName = "AllowBasic"
$ValueData = 0  # 0 = Disabled

# Ensure the registry path exists
if (-not (Test-Path $RegistryPath)) {
    Write-Output "Registry path does not exist. Creating path: $RegistryPath"
    New-Item -Path $RegistryPath -Force | Out-Null
}

# Set the registry value
Write-Output "Disabling Basic authentication for the WinRM Client..."
Set-ItemProperty -Path $RegistryPath -Name $ValueName -Value $ValueData -Force

# Verify the registry value
$ConfiguredValue = (Get-ItemProperty -Path $RegistryPath -Name $ValueName -ErrorAction SilentlyContinue).$ValueName
if ($ConfiguredValue -eq $ValueData) {
    Write-Output "Verification successful: Basic authentication is disabled for the WinRM Client."
} else {
    Write-Error "Verification failed: Basic authentication is not configured as expected."
}

# Force Group Policy update
Write-Output "Enforcing Group Policy update..."
gpupdate /force
```
