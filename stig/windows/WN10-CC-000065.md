# STIG ID: [WN10-CC-000065](https://stigaview.com/products/win10/v2r8/WN10-CC-000065/)

## Vulnerability Discussion
Wi-Fi Sense automatically connects the system to known hotspots and networks that contacts have shared. It also allows the sharing of the system's known networks to contacts. Automatically connecting to hotspots and shared networks can expose a system to unsecured or potentially malicious systems.
Check

## Compliance Check
This is NA as of v1803 of Windows 10; Wi-Fi sense is no longer available.

If the following registry value does not exist or is not configured as specified, this is a finding.

Registry Hive: `HKEY_LOCAL_MACHINE`
Registry Path: `\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config\`

Value Name: `AutoConnectAllowedOEM`

Type: `REG_DWORD`
Value: `0x00000000 (0)`

## Remediation
Configure the policy value for Computer Configuration >> Administrative Templates >> Network >> WLAN Service >> WLAN Settings>> "Allow Windows to automatically connect to suggested open hotspots, to networks shared by contacts, and to hotspots offering paid services" to "Disabled".

v1507 LTSB does not include this group policy setting. It may be configured through other means such as using group policy from a later version of Windows 10 or a registry update.

## Powershell Remediation Script
```
# Check for administrative privileges
if (-not ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
    Write-Error "This script requires administrative privileges. Please run PowerShell as an administrator."
    exit
}

# Define the registry path and value
$RegistryPath = "HKLM:\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config"
$ValueName = "AutoConnectAllowedOEM"
$ValueData = 0  # 0 = Disabled

# Ensure the registry path exists
if (-not (Test-Path $RegistryPath)) {
    Write-Output "Registry path does not exist. Creating path: $RegistryPath"
    New-Item -Path $RegistryPath -Force | Out-Null
}

# Set the registry value
Write-Output "Disabling Wi-Fi Sense by setting AutoConnectAllowedOEM to 0..."
Set-ItemProperty -Path $RegistryPath -Name $ValueName -Value $ValueData -Force

# Verify the registry value
$ConfiguredValue = (Get-ItemProperty -Path $RegistryPath -Name $ValueName -ErrorAction SilentlyContinue).$ValueName
if ($ConfiguredValue -eq $ValueData) {
    Write-Output "Verification successful: Wi-Fi Sense is disabled (AutoConnectAllowedOEM is set to 0)."
} else {
    Write-Error "Verification failed: AutoConnectAllowedOEM is not configured as expected."
}

# Force Group Policy update
Write-Output "Enforcing Group Policy update..."
gpupdate /force
```
